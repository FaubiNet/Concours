<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hackers Academy - Hall of Fame</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyber-gradient: linear-gradient(45deg, #22c55e, #0ea5e9, #8b5cf6);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #0a0a0a;
            overflow-x: hidden;
        }

        .cyber-glow {
            animation: cyberGlow 2s infinite alternate;
        }

        @keyframes cyberGlow {
            0% { filter: drop-shadow(0 0 5px rgba(14, 165, 233, 0.3)); }
            100% { filter: drop-shadow(0 0 20px rgba(34, 197, 94, 0.6)); }
        }

        .winner-card {
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            background: linear-gradient(145deg, #111111, #1e1e1e);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .winner-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(34, 197, 94, 0.15);
        }

        .particle {
            animation: particleFlow 3s linear infinite;
        }

        @keyframes particleFlow {
            0% { transform: translateY(-100%) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        .reward-card {
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
        }

        .animate-pop {
            animation: popIn 0.6s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            90% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .reward-detail-enter {
    opacity: 0;
    transform: scale(0.95);
}
.reward-detail-enter-active {
    opacity: 1;
    transform: scale(1);
    transition: all 0.3s ease-out;
}
.reward-detail-exit {
    opacity: 1;
    transform: scale(1);
}
.reward-detail-exit-active {
    opacity: 0;
    transform: scale(0.95);
    transition: all 0.2s ease-in;
}
.notification {
    position: fixed;
    top: 1rem;
    right: -100%;
    padding: 1rem 2rem;
    border-radius: 0.5rem;
    color: white;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 0.8rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.notification.show {
    right: 1rem;
}

.notification.error { 
    background: #dc2626;
    border-left: 4px solid #991b1b;
}

.notification.success { 
    background: #059669;
    border-left: 4px solid #065f46;
}

.notification.warning { 
    background: #d97706;
    border-left: 4px solid #92400e;
}

.notification::before {
    content: '';
    width: 24px;
    height: 24px;
    background-size: contain;
    background-repeat: no-repeat;
}

.notification.error::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>');
}

.notification.success::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>');
}

.notification.warning::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" /></svg>');
}
    .particle {
    animation: particleFlow 3s linear forwards;
}

@keyframes particleFlow {
    0% { 
        transform: translateY(0) rotate(0deg); 
        opacity: 1;
    }
    100% { 
        transform: translateY(100vh) rotate(360deg); 
        opacity: 0;
    }
}

.celebration-explosion {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
    text-align: center;
}

.celebration-text {
    font-size: 4rem;
    background: linear-gradient(45deg, #22c55e, #0ea5e9, #8b5cf6);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    animation: textPop 1s ease-out;
}

@keyframes textPop {
    0% { transform: scale(0); opacity: 0; }
    80% { transform: scale(1.2); }
    100% { transform: scale(1); opacity: 1; }
}

@keyframes particleExplosion {
    0% {
        transform: translate(0, 0);
        opacity: 1;
    }
    100% {
        transform: translate(var(--translateX), var(--translateY));
        opacity: 0;
    }
}
.pack-preview {
    border: 2px solid #8b5cf6;
    border-radius: 1rem;
    box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
    transition: transform 0.3s ease;
}

.pack-preview:hover {
    transform: scale(1.02);
}
    </style>
</head>
<body class="min-h-screen text-gray-100 relative">
    <!-- Page Principale -->
    <main id="mainPage" class="container mx-auto px-4 py-8 md:py-12">
        <h1 class="text-3xl md:text-4xl font-bold mb-12 text-center cyber-glow">
            üî• Top Hackers 2025
            <div class="mt-3 h-1 bg-gradient-to-r from-purple-500 to-cyan-500 w-20 mx-auto rounded-full"></div>
        </h1>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
            <!-- Gagnant 1 -->
            <div class="winner-card p-6 rounded-xl cursor-pointer relative overflow-hidden group" 
                 data-position="1" 
                 onclick="handleCardClick(this)">
                <div class="absolute inset-0 bg-gradient-to-br from-cyan-500/20 to-purple-500/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="text-5xl mb-3 animate-pulse">üëë</div>
                <h3 class="text-xl font-bold mb-1">CyberPhantom</h3>
                <p class="text-cyan-400 font-mono text-sm">24K points</p>
                <div class="mt-3 opacity-80 group-hover:opacity-100 transition-opacity">
                    <span class="text-xs text-gray-400">Cliquez pour d√©verrouiller</span>
                </div>
            </div>

            <!-- Gagnant 2 -->
            <div class="winner-card p-6 rounded-xl cursor-pointer relative overflow-hidden group" 
                 data-position="2" 
                 onclick="handleCardClick(this)">
                <div class="absolute inset-0 bg-gradient-to-br from-emerald-500/20 to-cyan-500/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="text-5xl mb-3 animate-pulse">üíª</div>
                <h3 class="text-xl font-bold mb-1">CodeBreaker</h3>
                <p class="text-emerald-400 font-mono text-sm">22K points</p>
                <div class="mt-3 opacity-80 group-hover:opacity-100 transition-opacity">
                    <span class="text-xs text-gray-400">Cliquez pour d√©verrouiller</span>
                </div>
            </div>

            <!-- Gagnant 3 -->
            <div class="winner-card p-6 rounded-xl cursor-pointer relative overflow-hidden group" 
                 data-position="3" 
                 onclick="handleCardClick(this)">
                <div class="absolute inset-0 bg-gradient-to-br from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="text-5xl mb-3 animate-pulse">üéØ</div>
                <h3 class="text-xl font-bold mb-1">ZeroDay</h3>
                <p class="text-purple-400 font-mono text-sm">20K points</p>
                <div class="mt-3 opacity-80 group-hover:opacity-100 transition-opacity">
                    <span class="text-xs text-gray-400">Cliquez pour d√©verrouiller</span>
                </div>
            </div>

            <!-- Gagnant 4 -->
            <div class="winner-card p-6 rounded-xl cursor-pointer relative overflow-hidden group" 
                 data-position="4" 
                 onclick="handleCardClick(this)">
                <div class="absolute inset-0 bg-gradient-to-br from-yellow-500/20 to-red-500/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="text-5xl mb-3 animate-pulse">üõ°Ô∏è</div>
                <h3 class="text-xl font-bold mb-1">ShadowHawk</h3>
                <p class="text-yellow-400 font-mono text-sm">19K points</p>
                <div class="mt-3 opacity-80 group-hover:opacity-100 transition-opacity">
                    <span class="text-xs text-gray-400">Cliquez pour d√©verrouiller</span>
                </div>
            </div>
        </div>
        <div id="notification" class="notification hidden"></div>

    </main>

      <!-- Page de R√©compenses -->
      <div id="rewardPage" class="hidden fixed inset-0 bg-gray-900 p-4 md:p-8 overflow-y-auto">
        <div class="max-w-4xl mx-auto">
            <button onclick="closeRewardPage()" class="mb-8 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors">
                ‚Üê Retour au Hall
            </button>
            <div id="rewardHeader" class="text-center mb-12 animate-pop">
                <div id="celebrationEmoji" class="text-8xl mb-6"></div>
                <h2 id="celebrationTitle" class="text-4xl font-bold mb-4"></h2>
                <div id="celebrationSubtitle" class="text-xl text-gray-400">
                    Vous avez d√©bloqu√© le niveau ultime !
                </div>
            </div>
            <div id="rewardsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>

        <!-- Modale de D√©tail des R√©compenses -->
<div id="rewardDetailModal" class="hidden fixed inset-0 bg-black/90 backdrop-blur-sm z-50 overflow-y-auto">
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-2xl max-w-2xl w-full p-8 relative">
            <button onclick="closeRewardDetail()" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                ‚úï
            </button>
            
            <div id="rewardDetailContent" class="space-y-6">
                <div class="text-6xl mb-4 text-center"></div>
                <h2 class="text-3xl font-bold text-center"></h2>
                <p class="text-gray-300 text-lg leading-relaxed"></p>
                <div class="mt-8 flex justify-center">
                    <button onclick="triggerDownload()" 
                            class="bg-gradient-to-r from-cyan-600 to-emerald-600 hover:opacity-90 px-8 py-3 rounded-lg font-bold transition-all">
                        T√©l√©charger
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
    </div>

    <!-- Prompt Personnalis√© -->
    <div id="customPrompt" class="hidden fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center">
        <div class="bg-gray-900 rounded-xl p-6 w-full max-w-xs mx-4">
            <div class="text-2xl mb-4 text-cyan-400">üîí Authentification Requise</div>
            
            <div id="passwordError" class="text-red-400 text-sm mb-2 hidden"></div>
            
            <input id="passwordInput" type="password" 
                   class="w-full bg-gray-800 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-cyan-500 outline-none transition-all"
                   placeholder="Mot de passe secret">
            
            <div class="flex gap-3">
                <button id="verifyButton" onclick="verifyPassword()" 
                        class="flex-1 bg-gradient-to-r from-cyan-600 to-emerald-600 hover:opacity-90 py-2 rounded-lg transition-all flex items-center justify-center">
                    <span id="verifyText">V√©rifier</span>
                    <div id="verifySpinner" class="hidden ml-2">
                        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </div>
                </button>
                <button onclick="closePrompt()" 
                        class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg transition-all">
                    Annuler
                </button>
            </div>
        </div>
    </div>


    <script>
        const WINNERS_DATA = {
            1: {
                name: "1er Gagnant",
                color: "from-amber-500 to-yellow-500",
                rewards: [
                    { title: "Collection Apps Hacking", icon: "üíª", description: "Apps piratage WiFi, terminal Android, spying, DDoS, crypto", downloadKey: "apps-hacking" },
                    { title: "Piratage par Image", icon: "üñºÔ∏è", description: "Proc√©dure compl√®te piratage via envoi d'image", downloadKey: "image-hack" },
                    { title: "PDF Python", icon: "üìñ", description: "Livres complets Python √©tape par √©tape", downloadKey: "python-pdf" },
                    { title: "Cours Hacking WiFi", icon: "üì∂", description: "M√©thodes avanc√©es de piratage WiFi", downloadKey: "wifi-course" },
                    { title: "PDF HTML/CSS", icon: "üìö", description: "Guides d√©taill√©s d√©veloppement web", downloadKey: "html-css" },
                    { title: "Astuces IA", icon: "ü§ñ", description: "Cr√©ation avatars/vid√©os r√©mun√©ratrices", downloadKey: "ia-tips" }
                ],
                sound: "https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3",
                medal: "ü•á"
            },
            2: {
                name: "2e Gagnant",
                color: "from-slate-500 to-blue-500",
                rewards: [
                    { title: "Psychologie Manipulation", icon: "üß†", description: "Apprendre √† influencer et manipuler les gens", downloadKey: "psycho-manip" },
                    { title: "PDF Python/HTML/CSS", icon: "üìò", description: "Coffret complet langages programmation", downloadKey: "langages-pack" },
                    { title: "Cr√©ation Avatars IA", icon: "üé≠", description: "Guide complet avatars anim√©s avec IA", downloadKey: "avatars-ia" }
            
                ],
                sound: "https://assets.mixkit.co/active_storage/sfx/2754/2754-preview.mp3",
                medal: "ü•à"
            },
            3: {
                name: "3e Gagnant",
                color: "from-orange-500 to-red-500",
                rewards: [
                    { title: "PDF HTML/CSS", icon: "üìë", description: "Documentation technique d√©taill√©e", downloadKey: "html-css-docs"  },
                    { title: "Liste Brute Force", icon: "üîë", description: "Dictionnaire de mots de passe optimis√©s", downloadKey: "brute-force-list" },
                    { title: "Android Root Guide", icon: "üì±", description: "Hacking complet avec Android root√©", downloadKey: "android-root" }
                ],
                sound: "https://assets.mixkit.co/active_storage/sfx/2755/2755-preview.mp3",
                medal: "ü•â"
            },
            4: {
                name: "4e Gagnant",
                color: "from-green-500 to-emerald-500",
                rewards: [
                    { title: "Terminal + Crypto Apps", icon: "üì≤", description: "Outils Android essentiels", downloadKey: "terminal-apps" },
                    { title: "Mini Guide Photoshop", icon: "üñåÔ∏è", description: "Bases du montage photo pro", downloadKey: "photoshop-guide" },
                    { title: "WiFi D√©butant", icon: "üì°", description: "Introduction au hacking WiFi" , downloadKey: "wifi-debutant"}
                ],
                sound: "https://assets.mixkit.co/active_storage/sfx/2753/2753-preview.mp3",
                medal: "üèÖ"
            }
        };

        

        let currentWinner;

        // Fonction de notification
function showNotification(message, type = 'info') {
    const notification = document.getElementById('notification');
    notification.className = `notification ${type} show`;
    notification.textContent = message;
    notification.classList.remove('hidden');
    
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.classList.add('hidden'), 300);
    }, 3000);
}

// Version modifi√©e de verifyPassword
async function verifyPassword() {
    const input = document.getElementById('passwordInput').value;
    const verifyBtn = document.getElementById('verifyButton');
    const verifyText = document.getElementById('verifyText');
    const verifySpinner = document.getElementById('verifySpinner');
    const errorDiv = document.getElementById('passwordError');

    verifyBtn.disabled = true;
    verifyText.classList.add('hidden');
    verifySpinner.classList.remove('hidden');
    errorDiv.classList.add('hidden');

    try {
        const response = await fetch('/.netlify/functions/verify-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ position: currentWinner, password: input })
        });

        const data = await response.json(); // Lecture unique

        if (!response.ok) {
            throw new Error(data.error || 'Erreur serveur');
        }

        if(data.valid) {
            sessionStorage.setItem('validatedPosition', currentWinner);
            closePrompt();
            createParticles(WINNERS_DATA[currentWinner].color.split(' ')[0].replace('from-', '#'));
            new Audio(WINNERS_DATA[currentWinner].sound).play();
            showCelebration(WINNERS_DATA[currentWinner]);
            
            setTimeout(() => {
                showRewardPage(WINNERS_DATA[currentWinner]);
            }, 2000);
            
            showNotification('Acc√®s autoris√© !', 'success');
        } else {
            errorDiv.textContent = '‚õî Mot de passe incorrect !';
            errorDiv.classList.remove('hidden');
            showNotification('√âchec de l\'authentification', 'error');
        }
    } catch (error) {
        console.error('Erreur:', error);
        const message = error.message.includes('Failed to fetch') 
            ? 'Probl√®me de connexion au serveur'
            : error.message;
        
        errorDiv.textContent = `‚ö†Ô∏è ${message}`;
        errorDiv.classList.remove('hidden');
        showNotification(message, 'warning');
    } finally {
        verifyBtn.disabled = false;
        verifyText.classList.remove('hidden');
        verifySpinner.classList.add('hidden');
    }
}

// Nouvelle fonction pour l'effet de c√©l√©bration
function showCelebration(winner) {
    // Cr√©ation de l'explosion de particules
    createParticles(winner.color.split(' ')[0].replace('from-', '#'));
    
    // Cr√©ation du message de f√©licitations
    const celebration = document.createElement('div');
    celebration.className = 'celebration-explosion';
    celebration.innerHTML = `
        <div class="celebration-text">
            <div class="text-8xl mb-4">${winner.medal}</div>
            <h2 class="text-5xl font-bold">F√©licitations !</h2>
            <p class="text-2xl mt-4 text-cyan-400">${winner.name}</p>
        </div>
    `;
    
    document.body.appendChild(celebration);
    
    // Ajout du son de c√©l√©bration
    const audio = new Audio(winner.sound);
    audio.play();
    
    // Suppression apr√®s l'animation
    setTimeout(() => {
        celebration.remove();
    }, 3000);
}
// Version modifi√©e de handleRewardClick
async function handleRewardClick(downloadKey) {
    const validatedPosition = sessionStorage.getItem('validatedPosition');
    if (!validatedPosition) {
        showNotification('Session expir√©e ! Veuillez vous reconnecter', 'error');
        return closeRewardDetail();
    }
    
    let downloadBtn, originalText;

    try {
        downloadBtn = document.querySelector('#rewardDetailModal button');
        originalText = downloadBtn.innerHTML;
        
        downloadBtn.innerHTML = `
            <svg class="animate-spin h-5 w-5 mr-2" viewBox="0 0 24 24">
                <path fill="currentColor" d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"/>
            </svg>
            Pr√©paration...
        `;
        downloadBtn.disabled = true;

        const response = await fetch('/.netlify/functions/get-download', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ position: validatedPosition, downloadKey })
        });

        if (!response.ok) {
            const error = await response.json();
            throw new Error(error.error || 'Erreur lors du t√©l√©chargement');
        }

        const result = await response.json();
        
        if (result.url) {
            const link = document.createElement('a');
            link.href = result.url;
            link.download = true;
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            downloadBtn.innerHTML = '‚úÖ T√©l√©charg√© !';
            setTimeout(() => {
                downloadBtn.innerHTML = originalText;
                downloadBtn.disabled = false;
            }, 2000);
            
            showNotification('T√©l√©chargement d√©marr√©', 'success');
        }
    } catch (error) {
        console.error('Erreur:', error);
        downloadBtn.innerHTML = '‚ùå √âchec';
        setTimeout(() => {
            downloadBtn.innerHTML = originalText;
            downloadBtn.disabled = false;
        }, 2000);
        
        showNotification(error.message, 'error');
    }
}

function createParticles(baseColor) {
    const colors = [baseColor, '#0ea5e9', '#8b5cf6'];
    const container = document.createElement('div');
    container.style.position = 'fixed';
    container.style.top = '50%';
    container.style.left = '50%';
    container.style.transform = 'translate(-50%, -50%)';
    container.style.pointerEvents = 'none';
    document.body.appendChild(container);

    for (let i = 0; i < 100; i++) {
        const particle = document.createElement('div');
        const angle = (Math.random() * 360) * (Math.PI / 180);
        const velocity = Math.random() * 50 + 50;
        
        particle.className = 'particle';
        particle.style.cssText = `
            position: absolute;
            width: 8px;
            height: 8px;
            background: ${colors[i % 3]};
            border-radius: 50%;
            animation: particleExplosion 1s ease-out forwards;
            --translateX: ${Math.cos(angle) * velocity}vw;
            --translateY: ${Math.sin(angle) * velocity}vh;
        `;
        
        container.appendChild(particle);

        particle.addEventListener('animationend', () => {
            particle.remove();
            if (!container.hasChildNodes()) {
                container.remove();
            }
        });
    }
}



// AJOUT DE LA FONCTION MANQUANTE
function handleCardClick(element) {
    currentWinner = element.dataset.position;
    showCustomPrompt();
}

        function showRewardPage(winner) {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('rewardPage').classList.remove('hidden');
            
            document.getElementById('celebrationEmoji').textContent = winner.medal;
            document.getElementById('celebrationTitle').textContent = `F√©licitations ${winner.name}!`;
            document.getElementById('celebrationTitle').style.background = `linear-gradient(45deg, ${winner.color.replace('from-', '').replace('to-', '').replace(/ /g, ', ')})`;
            document.getElementById('celebrationTitle').style.webkitBackgroundClip = 'text';
            document.getElementById('celebrationTitle').style.webkitTextFillColor = 'transparent';

             const grid = document.getElementById('rewardsGrid');
    grid.innerHTML = winner.rewards.map((reward, index) => `
        <div class="reward-card p-6 rounded-xl transform transition-all hover:scale-[1.02] delay-${index * 100} cursor-pointer"
             onclick="showRewardDetail(${JSON.stringify(reward).replace(/"/g, '&quot;')})">
            <div class="text-4xl mb-3">${reward.icon}</div>
            <h3 class="text-xl font-bold mb-2" style="color: ${winner.color.split(' ')[0].replace('from-', '#')}">${reward.title}</h3>
            <p class="text-gray-300 text-sm">${reward.description}</p>
        </div>
    `).join('');
}


let currentDownloadKey = null;

function showRewardDetail(reward) {
    const modal = document.getElementById('rewardDetailModal');
    const content = document.getElementById('rewardDetailContent');
    const validatedPosition = sessionStorage.getItem('validatedPosition');

    content.querySelector('.text-6xl').innerHTML = reward.icon;
    content.querySelector('h2').textContent = reward.title;
    content.querySelector('p').textContent = reward.description;

    const buttonContainer = content.querySelector('.mt-8.flex.justify-center');
    
    // Uniquement pour le premier pack du premier gagnant
    if (validatedPosition === '1' && reward.downloadKey === 'apps-hacking') {
        buttonContainer.innerHTML = `
            <div class="text-center w-full">
                <p class="text-yellow-400 mb-4">‚ö†Ô∏è Ce pack est trop volumineux pour l'upload.<br>
                Patientez jusqu'√† la fin du transfert...<br>
                (${new Date().toLocaleDateString()})</p>
                
                <button onclick="viewPackPreview()" 
                        class="bg-gradient-to-r from-purple-600 to-pink-600 hover:opacity-90 px-6 py-2 rounded-lg font-bold transition-all">
                    üì∏ Voir l'aper√ßu du pack
                </button>
            </div>
        `;
    } else {
        // Comportement normal pour toutes les autres r√©compenses
        buttonContainer.innerHTML = `
            <button onclick="triggerDownload()" 
                    class="bg-gradient-to-r from-cyan-600 to-emerald-600 hover:opacity-90 px-8 py-3 rounded-lg font-bold transition-all">
                T√©l√©charger
            </button>
        `;
    }

    currentDownloadKey = reward.downloadKey;
    modal.classList.remove('hidden');
}

function closeRewardDetail() {
    document.getElementById('rewardDetailModal').classList.add('hidden');
    currentDownloadKey = null;
}

function viewPackPreview() {
    const previewUrl = "https://i.postimg.cc/rw015B6S/apps-for-hackers.png";
    const previewWindow = window.open('', 'Aper√ßu du Pack', 'width=800,height=600');
    previewWindow.document.write(`
        <html>
            <head><title>Aper√ßu du Pack</title></head>
            <body style="background: #0a0a0a; display: flex; justify-content: center; align-items: center;">
                <img src="${previewUrl}" style="max-width: 100%; max-height: 100%; border-radius: 1rem;">
            </body>
        </html>
    `);
}

async function triggerDownload() {
    if (!currentDownloadKey) return;
    
    const validatedPosition = sessionStorage.getItem('validatedPosition');
    
    // Blocage uniquement pour le pack sp√©cifique
    if (validatedPosition === '1' && currentDownloadKey === 'apps-hacking') {
        showNotification('üöß Le transfert est en cours - merci de patienter ! (Estimation: 24h)', 'warning');
        return;
    }

    try {
        await handleRewardClick(currentDownloadKey);
        closeRewardDetail();
    } catch (error) {
        console.error('Erreur:', error);
        showNotification('√âchec du t√©l√©chargement', 'error');
    }
}


        function closeRewardPage() {
            document.getElementById('rewardPage').classList.add('hidden');
            document.getElementById('mainPage').classList.remove('hidden');
            document.querySelectorAll('.particle').forEach(p => p.remove());
        }

        function showCustomPrompt() {
            document.getElementById('customPrompt').classList.remove('hidden');
        }

        function closePrompt() {
            document.getElementById('customPrompt').classList.add('hidden');
            document.getElementById('passwordInput').value = '';
        }
    </script>
</body>
</html>